@model CommunityConnections.ViewModels.CustomerActionViewModel

@{
    ViewBag.Title = "Action";
}

@if (Model != null)
{

<div class="card">
    <div class="card-body">
        <h2 class="card-title">
            @if (Model.ID != 0)
            {
                <span>Edit Customer Information</span>
            }
            else
            {
                <span>Save Customer Information</span>
            }
        </h2>
        <hr />




        <form id="actionForm">
            <div class="row">
                <div class="col-md-6">
                    <input type="hidden" id="ID" name="ID" value="@Model.ID" />

                    <div class="form-row col-md-12">
                        <div class="form-group col-md-12">

                            @Html.LabelFor(model => model.Compnay, htmlAttributes: new { @class = "control-label col-md-12" })
                            @Html.EditorFor(model => model.Compnay, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.Compnay, "", new { @class = "text-danger" })



                        </div>


                    </div>

                    <div class="form-row col-md-12">



                        <div class="form-group col-md-3">
                            @Html.LabelFor(model => model.Title, htmlAttributes: new { @class = "control-label col-md-12" })
                            @Html.EditorFor(model => model.Title, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.Title, "", new { @class = "text-danger" })

                        </div>


                        <div class="form-group col-md-3">
                            @Html.LabelFor(model => model.FirstName, htmlAttributes: new { @class = "control-label col-md-12" })
                            @Html.EditorFor(model => model.FirstName, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.FirstName, "", new { @class = "text-danger" })
                        </div>

                        <div class="form-group col-md-3">
                            @Html.LabelFor(model => model.MiddleName, htmlAttributes: new { @class = "control-label col-md-12" })
                            @Html.EditorFor(model => model.MiddleName, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.MiddleName, "", new { @class = "text-danger" })
                        </div>


                        <div class="form-group col-md-3">
                            @Html.LabelFor(model => model.LastName, htmlAttributes: new { @class = "control-label col-md-12" })
                            @Html.EditorFor(model => model.LastName, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.LastName, "", new { @class = "text-danger" })
                        </div>


                    </div>




                    <div class="form-row col-md-12">

                        <div class="form-group col-md-6">
                            @Html.LabelFor(model => model.Address, htmlAttributes: new { @class = "control-label col-md-12" })
                            @Html.EditorFor(model => model.Address, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.Address, "", new { @class = "text-danger" })
                        </div>

                        <div class="form-group col-md-6">
                            @Html.LabelFor(model => model.Country, htmlAttributes: new { @class = "control-label col-md-12" })
                            @Html.EditorFor(model => model.Country, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.Country, "", new { @class = "text-danger" })
                        </div>
                    </div>

                    <div class="form-row col-md-12">

                        <div class="form-group col-md-4">
                            @Html.LabelFor(model => model.City, htmlAttributes: new { @class = "control-label col-md-12" })
                            @Html.EditorFor(model => model.City, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.City, "", new { @class = "text-danger" })

                        </div>

                        <div class="form-group col-md-4">
                            @Html.LabelFor(model => model.State, htmlAttributes: new { @class = "control-label col-md-12" })
                            @Html.EditorFor(model => model.State, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.State, "", new { @class = "text-danger" })
                        </div>

                        <div class="form-group col-md-4">
                            @Html.LabelFor(model => model.AreaCode, htmlAttributes: new { @class = "control-label col-md-12" })
                            @Html.EditorFor(model => model.AreaCode, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.AreaCode, "", new { @class = "text-danger" })
                        </div>

                    </div>

                    <div class="form-row col-md-12">


                        <div class="form-group col-md-6">
                            @Html.LabelFor(model => model.Phone, htmlAttributes: new { @class = "control-label col-md-12" })
                            @Html.EditorFor(model => model.Phone, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.Phone, "", new { @class = "text-danger" })
                        </div>

                        <div class="form-group col-md-6">
                            @Html.LabelFor(model => model.OtherPhone, htmlAttributes: new { @class = "control-label col-md-12" })

                            @Html.EditorFor(model => model.OtherPhone, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.OtherPhone, "", new { @class = "text-danger" })
                        </div>
                    </div>

                    <div class="form-row col-md-12">
                        <div class="form-group col-md-6">

                            @Html.LabelFor(model => model.Fax, htmlAttributes: new { @class = "control-label col-md-12" })
                            @Html.EditorFor(model => model.Fax, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.Fax, "", new { @class = "text-danger" })
                        </div>

                        <div class="form-group col-md-6">
                            @Html.LabelFor(model => model.Email, htmlAttributes: new { @class = "control-label col-md-12" })
                            @Html.EditorFor(model => model.Email, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.Email, "", new { @class = "text-danger" })
                        </div>

                    </div>
                    <div class="form-row col-md-12">

                        <div class="form-group col-md-6">
                            @Html.LabelFor(model => model.BillingEmail, htmlAttributes: new { @class = "control-label col-md-12" })
                            @Html.EditorFor(model => model.BillingEmail, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.BillingEmail, "", new { @class = "text-danger" })
                        </div>


                    </div>






                </div>

                <div class="col-md-6">
                    <div class="card">
                        <div class="card-body">

                            <ul class="nav nav-tabs" id="myTab">
                                <li class="active"><a class="btn btn-outline-primary" href="#notes" data-toggle="tab">Note</a></li>
                                <li><a class="btn btn-outline-primary " href="#popupMessage" data-toggle="tab">Billing Info</a></li>
                                <li><a class="btn btn-outline-primary" href="#customerpricing" data-toggle="tab">Customer Pricing</a></li>
                                <li><a class="btn btn-outline-primary" href="#cards" data-toggle="tab">Cards</a></li>
                            </ul>




                            <div class="tab-content">
                                <!-- First tab starts here -->
                                <div class="tab-pane active" id="notes">
                                    <!-- notice the ID of the tab-pane matches the href of the List item from the navigation -->
                                    <div class="rsform-block rsform-block-name">


                                        <div class="form-group col-md-12">
                                            @Html.LabelFor(model => model.Notes, htmlAttributes: new { @class = "control-label col-md-12" })
                                            <input style="height:200px;" type="text" value="@Model.Notes" class="form-control" />
                                            @Html.ValidationMessageFor(model => model.Notes, "", new { @class = "text-danger" })
                                        </div>

                                        <div class="form-group col-md-12">
                                            @Html.LabelFor(model => model.PopupMessage, htmlAttributes: new { @class = "control-label col-md-12" })
                                            @Html.EditorFor(model => model.PopupMessage, new { htmlAttributes = new { @class = "form-control" } })
                                            @Html.ValidationMessageFor(model => model.PopupMessage, "", new { @class = "text-danger" })
                                        </div>




                                    </div>

                                </div>

                                <!-- Second tab starts here -->
                                <div class="tab-pane" id="popupMessage">
                                    <div class="rsform-block rsform-block-email">
                                        <div class="form-group col-md-12">
                                            @Html.LabelFor(model => model.CustomerBalance, htmlAttributes: new { @class = "control-label col-md-12" })
                                            @Html.EditorFor(model => model.CustomerBalance, new { htmlAttributes = new { @class = "form-control" } })
                                            @Html.ValidationMessageFor(model => model.CustomerBalance, "", new { @class = "text-danger" })
                                        </div>


                                    </div>
                                    <div class="rsform-block rsform-block-telephone">
                                        <div class="form-group col-md-12">

                                            @Html.LabelFor(model => model.PaymentMethod, htmlAttributes: new { @class = "control-label col-md-12" })
                                            @Html.EditorFor(model => model.PaymentMethod, new { htmlAttributes = new { @class = "form-control" } })
                                            @Html.ValidationMessageFor(model => model.PaymentMethod, "", new { @class = "text-danger" })
                                        </div>
                                    </div>
                                </div>
                                <!-- Third tab starts here -->
                                <div class="tab-pane" id="cards">

                                    <div class="col-lg-12 grid-margin stretch-card">
                                        @if (Model != null)
                                        {
                                            if (Model.CustomPricings != null)
                                            {
                                                <div class="card">

                                                    <div class="table-responsive">
                                                        <table class="table table-striped table-hover">
                                                            <thead>
                                                                <tr>

                                                                    <th>
                                                                        Card Name
                                                                    </th>
                                                                    <th>
                                                                        Card Number
                                                                    </th>
                                                                    <th>
                                                                        Expiration Date
                                                                    </th>



                                                                    <th>
                                                                        Action
                                                                    </th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                @foreach (var item in Model.Cards)
                                                                {
                                                                    <tr>
                                                                        <td>@item.CardName</td>
                                                                        <td class="cardNumber">@item.CardNumber</td>
                                                                        <td>@item.ExpirationDate</td>

                                                                        <td>
                                                                            <button data-href="@Url.Action("CardAction", "Customer", new { ID = item.ID })" type="button" class="data-btn btn btn-outline-info btn-icon-text" data-toggle="modal" data-target="#actionModal"><i class="mdi mdi-pencil"></i> EDIT</button>
                                                                            <button data-href="@Url.Action("CardDelete", "Customer", new { ID = item.ID })" type="button" class="data-btn btn btn-outline-danger btn-icon-text" data-toggle="modal" data-target="#actionModal"><i class="mdi mdi-delete"></i>DELETE</button>


                                                                        </td>
                                                                    </tr>
                                                                }
                                                            </tbody>
                                                        </table>
                                                    </div>

                                                </div>
                                            }
                                        }
                                        else
                                        {
                                            <div class="alert alert-warning col-md-12" role="alert">
                                                Sorry! No records exist.
                                            </div>
                                        }
                                    </div>
                                </div>


                                <div class="tab-pane" id="customerpricing">
                                    <div class="col-lg-12 grid-margin stretch-card">
                                        @if (Model != null)
                                        {
                                            if (Model.CustomPricings != null)
                                            {
                                                <div class="card">

                                                    <div class="table-responsive">
                                                        <table class="table table-striped table-hover">
                                                            <thead>
                                                                <tr>

                                                                    <th>
                                                                        AdSize
                                                                    </th>
                                                                    <th>
                                                                        Price
                                                                    </th>
                                                                    <th>
                                                                        Custom Notes
                                                                    </th>



                                                                    <th>
                                                                        Action
                                                                    </th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                @foreach (var item in Model.CustomPricings)
                                                                {
                                                                    <tr>
                                                                        <td>@item.AdSize</td>
                                                                        <td>@item.Price</td>
                                                                        <td>@item.CustomNotes</td>

                                                                        <td>
                                                                            <button data-href="@Url.Action("CPAction", "Customer", new { ID = item.ID })" type="button" class="data-btn btn btn-outline-info btn-icon-text" data-toggle="modal" data-target="#actionModal"><i class="mdi mdi-pencil"></i> EDIT</button>
                                                                            <button data-href="@Url.Action("CPDelete", "Customer", new { ID = item.ID })" type="button" class="data-btn btn btn-outline-danger btn-icon-text" data-toggle="modal" data-target="#actionModal"><i class="mdi mdi-delete"></i>DELETE</button>


                                                                        </td>
                                                                    </tr>
                                                                }
                                                            </tbody>
                                                        </table>
                                                    </div>

                                                </div>
                                            }
                                        }
                                        else
                                        {
                                            <div class="alert alert-warning col-md-12" role="alert">
                                                Sorry! No records exist.
                                            </div>
                                        }
                                    </div>
                                </div>









                            </div>
                        </div>
                    </div>
                </div>
                <br />
                <div class="col-md-12">
                    @if (Model.ID != 0)
                    {
                        <button id="actionButton" type="button" class="btn btn-outline-primary"><i class="fas fa-save mr-1"></i> UPDATE</button>
                    }
                    else
                    {
                        <button id="actionButton" type="button" class="btn btn-outline-primary "><i class="fas fa-save mr-1"></i> SAVE</button>
                    }
                    <a href="@Url.Action("Index","Customer")" class="btn btn-outline-danger"> CANCEL</a>
                </div>
                </div>
            <hr />
            <div class="row">
                <div class="col-md-12">
                    <div class="col-md-6">
                        <label class="control-label col-md-12">Add Cards</label>
                        <button data-href="@Url.Action("CardAction", "Customer")" class="data-btn btn btn-block btn-outline-success" type="button" data-toggle="modal" data-target="#actionModal"><i class="fas fa-plus mr-1"></i> Add Cards</button>
                        <label class="control-label col-md-12">Add Custom Pricing</label>

                        <button data-href="@Url.Action("Action", "CustomPricings")" class="data-btn btn btn-block btn-outline-success" type="button" data-toggle="modal" data-target="#actionModal"><i class="fas fa-plus mr-1"></i> Add Custom Pricing</button>
                    </div>
                </div>
            </div>
        </form>





    </div>


   
</div>







    <div class="modal fade" id="actionModal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
        </div>
    </div>


    <div class="errorDiv">

    </div>

}




<script>
     $("#actionButton").click(function () {
		$.ajax({
			url: '@Url.Action("Action", "Customer")',
			type: "post",
			data: $("#actionForm").serialize()
		})
		.done(function () {

            window.location.href = "@Url.Action("Index","Customer")";

		});
     });


    //$(document).ready(function () {
    //    var ssn = document.getElementsByClassName('cardNumber');
    //    document.getElementsByClassName('cardNumber').value = "*****" + ssn.substr(ssn.length - 4);

    //});


    $(".data-btn").click(function () {
        $.ajax({
            url: $(this).attr("data-href"),
        })
            .done(function (response) {
                $("#actionModal .modal-dialog").html(response);
            });
    });
</script>

